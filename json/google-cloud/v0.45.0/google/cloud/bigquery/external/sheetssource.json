{"id":"google/cloud/bigquery/external/sheetssource","name":"SheetsSource","title":["Google","Cloud","Bigquery","External","SheetsSource"],"description":"<h1 id=\"sheetssource\">SheetsSource</h1>\n\n<p><a data-custom-type=\"google/cloud/bigquery/external/sheetssource\">External::SheetsSource</a> is a subclass of <a data-custom-type=\"google/cloud/bigquery/external/datasource\">External::DataSource</a> and\nrepresents a Google Sheets external data source that can be queried\nfrom directly, even though the data is not stored in BigQuery. Instead\nof loading or streaming the data, this object references the external\ndata source.</p>","source":"google-cloud-bigquery/lib/google/cloud/bigquery/external.rb#L1160","resources":[],"examples":[{"caption":"","code":"require \"google/cloud/bigquery\"\n\nbigquery = Google::Cloud::Bigquery.new\n\nsheets_url = \"https://docs.google.com/spreadsheets/d/1234567980\"\nsheets_table = bigquery.external sheets_url do |sheets|\n  sheets.skip_leading_rows = 1\nend\n\ndata = bigquery.query \"SELECT * FROM my_ext_table\",\n                      external: { my_ext_table: sheets_table }\n\ndata.each do |row|\n  puts row[:name]\nend"}],"methods":[{"id":"skip_leading_rows-instance","type":"instance","name":"skip_leading_rows","title":["Google","Cloud","Bigquery","External","SheetsSource#skip_leading_rows"],"description":"<p>The number of rows at the top of a sheet that BigQuery will skip\nwhen reading the data. The default value is <code>0</code>.</p>\n\n<p>This property is useful if you have header rows that should be\nskipped. When <code>autodetect</code> is on, behavior is the following:</p>\n\n<ul>\n  <li><code>nil</code> - Autodetect tries to detect headers in the first row. If\nthey are not detected, the row is read as data. Otherwise data is\nread starting from the second row.</li>\n  <li><code>0</code> - Instructs autodetect that there are no headers and data\nshould be read starting from the first row.</li>\n  <li><code>N &gt; 0</code> - Autodetect skips <code>N-1</code> rows and tries to detect headers\nin row <code>N</code>. If headers are not detected, row <code>N</code> is just skipped.\nOtherwise row <code>N</code> is used to extract column names for the detected\nschema.</li>\n</ul>","source":"google-cloud-bigquery/lib/google/cloud/bigquery/external.rb#L1200","resources":[],"examples":[{"caption":"","code":"require \"google/cloud/bigquery\"\n\nbigquery = Google::Cloud::Bigquery.new\n\nsheets_url = \"https://docs.google.com/spreadsheets/d/1234567980\"\nsheets_table = bigquery.external sheets_url do |sheets|\n  sheets.skip_leading_rows = 1\nend\n\nsheets_table.skip_leading_rows #=> 1"}],"params":[],"exceptions":[],"returns":[{"types":["Integer"],"description":""}]},{"id":"skip_leading_rows=-instance","type":"instance","name":"skip_leading_rows=","title":["Google","Cloud","Bigquery","External","SheetsSource#skip_leading_rows="],"description":"<p>Set the number of rows at the top of a sheet that BigQuery will skip\nwhen reading the data.</p>","source":"google-cloud-bigquery/lib/google/cloud/bigquery/external.rb#L1222","resources":[],"examples":[{"caption":"","code":"require \"google/cloud/bigquery\"\n\nbigquery = Google::Cloud::Bigquery.new\n\nsheets_url = \"https://docs.google.com/spreadsheets/d/1234567980\"\nsheets_table = bigquery.external sheets_url do |sheets|\n  sheets.skip_leading_rows = 1\nend\n\nsheets_table.skip_leading_rows #=> 1"}],"params":[{"name":"row_count","types":["Integer"],"description":"New skip_leading_rows value","optional":false,"nullable":false}],"exceptions":[],"returns":[]}]}