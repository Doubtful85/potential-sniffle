{"id":"google/cloud/spanner/policy","name":"Policy","title":["Google","Cloud","Spanner","Policy"],"description":"<h1 id=\"policy\">Policy</h1>\n\n<p>Represents a Cloud IAM Policy for the Spanner service.</p>\n\n<p>A common pattern for updating a resourceâ€™s metadata, such as its Policy,\nis to read the current data from the service, update the data locally,\nand then send the modified data for writing. This pattern may result in\na conflict if two or more processes attempt the sequence simultaneously.\nIAM solves this problem with the Google::Cloud::Spanner::Policy#etag\nproperty, which is used to verify whether the policy has changed since\nthe last request. When you make a request to with an <code>etag</code> value, Cloud\nIAM compares the <code>etag</code> value in the request with the existing <code>etag</code>\nvalue associated with the policy. It writes the policy only if the\n<code>etag</code> values match.</p>\n\n<p>When you update a policy, first read the policy (and its current <code>etag</code>)\nfrom the service, then modify the policy locally, and then write the\nmodified policy to the service. See\nGoogle::Cloud::Spanner::Instance#policy and\nGoogle::Cloud::Spanner::Instance#policy= and\nGoogle::Cloud::Spanner::Database#policy and\nGoogle::Cloud::Spanner::Database#policy=.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L72","resources":[{"title":"Managing\npolicies","link":"https://cloud.google.com/iam/docs/managing-policies"},{"title":"google.iam.v1.IAMPolicy","link":"https://cloud.google.com/spanner/reference/rpc/google.iam.v1#google.iam.v1.Policy"}],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ninstance = spanner.instance \"my-instance\"\n\npolicy = instance.policy do |p|\n  p.remove \"roles/owner\", \"user:owner@example.com\"\n  p.add \"roles/owner\", \"user:newowner@example.com\"\n  p.roles[\"roles/viewer\"] = [\"allUsers\"]\nend"}],"methods":[{"id":"etag=-instance","type":"instance","name":"etag=","title":["Google","Cloud","Spanner","Policy#etag="],"description":"<p>Used to verify whether the policy has changed since\nthe last request. The policy will be written only if the <code>etag</code> values\nmatch.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L72","resources":[],"examples":[],"params":[{"name":"value","types":["String"],"description":"the value to set the attribute etag to.","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["String"],"description":"the newly set value"}]},{"id":"etag-instance","type":"instance","name":"etag","title":["Google","Cloud","Spanner","Policy#etag"],"description":"<p>Used to verify whether the policy has changed since\nthe last request. The policy will be written only if the <code>etag</code> values\nmatch.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L72","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["String"],"description":"the current value of etag"}]},{"id":"roles=-instance","type":"instance","name":"roles=","title":["Google","Cloud","Spanner","Policy#roles="],"description":"<p>The bindings that associate\nroles with an array of members. See <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Understanding\nRoles</a> for a\nlisting of primitive and curated roles.\nSee <a href=\"https://cloud.google.com/spanner/reference/rpc/google.iam.v1#google.iam.v1.Binding\">Binding</a>\nfor a listing of values and patterns for members.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L72","resources":[],"examples":[],"params":[{"name":"value","types":["Hash{String => Array<String>}"],"description":"the value to set the attribute roles to.","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Hash{String =&gt; Array&lt;String&gt;}"],"description":"the newly set value"}]},{"id":"roles-instance","type":"instance","name":"roles","title":["Google","Cloud","Spanner","Policy#roles"],"description":"<p>The bindings that associate\nroles with an array of members. See <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Understanding\nRoles</a> for a\nlisting of primitive and curated roles.\nSee <a href=\"https://cloud.google.com/spanner/reference/rpc/google.iam.v1#google.iam.v1.Binding\">Binding</a>\nfor a listing of values and patterns for members.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L72","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["Hash{String =&gt; Array&lt;String&gt;}"],"description":"the current value of roles"}]},{"id":"add-instance","type":"instance","name":"add","title":["Google","Cloud","Spanner","Policy#add"],"description":"<p>Convenience method for adding a member to a binding on this policy.\nSee <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Understanding\nRoles</a> for a\nlisting of primitive and curated roles.\nSee <a href=\"https://cloud.google.com/spanner/reference/rpc/google.iam.v1#google.iam.v1.Binding\">Binding</a>\nfor a listing of values and patterns for members.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L105","resources":[],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ninstance = spanner.instance \"my-instance\"\n\npolicy = instance.policy do |p|\n  p.add \"roles/owner\", \"user:newowner@example.com\"\nend"}],"params":[{"name":"role_name","types":["String"],"description":"A Cloud IAM role, such as\n<code>\"roles/spanner.admin\"</code>.","optional":false,"nullable":false},{"name":"member","types":["String"],"description":"A Cloud IAM identity, such as\n<code>\"user:owner@example.com\"</code>.","optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"remove-instance","type":"instance","name":"remove","title":["Google","Cloud","Spanner","Policy#remove"],"description":"<p>Convenience method for removing a member from a binding on this\npolicy. See <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Understanding\nRoles</a> for a\nlisting of primitive and curated roles. See\n<a href=\"https://cloud.google.com/spanner/reference/rpc/google.iam.v1#google.iam.v1.Binding\">Binding</a>\nfor a listing of values and patterns for members.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L132","resources":[],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ninstance = spanner.instance \"my-instance\"\n\npolicy = instance.policy do |p|\n  p.remove \"roles/owner\", \"user:owner@example.com\"\nend"}],"params":[{"name":"role_name","types":["String"],"description":"A Cloud IAM role, such as\n<code>\"roles/spanner.admin\"</code>.","optional":false,"nullable":false},{"name":"member","types":["String"],"description":"A Cloud IAM identity, such as\n<code>\"user:owner@example.com\"</code>.","optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"role-instance","type":"instance","name":"role","title":["Google","Cloud","Spanner","Policy#role"],"description":"<p>Convenience method returning the array of members bound to a role in\nthis policy, or an empty array if no value is present for the role in\n<a data-custom-type=\"google/cloud/spanner/policy\" data-method=\"roles-instance\">#roles</a>. See <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Understanding\nRoles</a> for a\nlisting of primitive and curated roles. See\n<a href=\"https://cloud.google.com/spanner/reference/rpc/google.iam.v1#google.iam.v1.Binding\">Binding</a>\nfor a listing of values and patterns for members.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L157","resources":[],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ninstance = spanner.instance \"my-instance\"\n\npolicy = instance.policy do |p|\n  p.role(\"roles/viewer\") << \"user:viewer@example.com\"\nend"}],"params":[],"exceptions":[],"returns":[{"types":["Array&lt;String&gt;"],"description":"The members strings, or an empty array."}]},{"id":"deep_dup-instance","type":"instance","name":"deep_dup","title":["Google","Cloud","Spanner","Policy#deep_dup"],"description":"<p>Returns a deep copy of the policy.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/policy.rb#L166","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"google/cloud/spanner/policy\">Policy</a>"],"description":""}]}]}